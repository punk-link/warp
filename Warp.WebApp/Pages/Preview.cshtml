@page "/preview/{id}"
@using Microsoft.Extensions.Localization
@model Warp.WebApp.Pages.PreviewModel
@inject Microsoft.AspNetCore.Mvc.Localization.IViewLocalizer Localizer
@inject IStringLocalizer<SharedResources> SharedLocalizer

@{
    ViewData["Title"] = SharedLocalizer["Title"];
}

@section MetaTags {
    <meta name="robots" content="noindex, noarchive">
}

@section Scripts {
    <script type="module" src="~/js/components/modal.js" defer></script>
    <script type="module" defer>
        import { addPreviewEvents } from '/js/preview.js';

        document.addEventListener('DOMContentLoaded', () => {
            addPreviewEvents('@Model.Id', '@Model.ExpiresIn');
        });
    </script>
}

<div class="min-h-screen">
    <div class="flex items-baseline px-3">
        <h1 class="logo-style">
            <a asp-page="/Index">
                @SharedLocalizer["Logo"]
            </a>
        </h1>
    </div>

    <section class="px-3 my-5">
        <div class="flex flex-col items-center justify-around min-h-[75vh]">
            <!-- Countdown -->
            <div class="w-full md:w-1/2 flex justify-end mb-5">
                <div class="text-right">
                    <div class="countdown text-gray-800 text-2xl font-sans-serif font-semibold">&nbsp;</div>
                    <div class="text-gray-400">
                        @Localizer["the entry expires in"]
                    </div>
                </div>
            </div>

            <!-- Content -->
            <article class="w-full md:w-1/2 bg-yellow-50 p-3 rounded-sm mb-5">
                @if (Model.ImageContainers.Count > 0)
                {
                    <div class="flex flex-row flex-wrap gap-3 upload-gallery mb-5">
                        @foreach (var imageContainer in Model.ImageContainers)
                        {
                            <partial name="Shared/Components/ReadOnlyImageContainer" model="imageContainer" />
                        }
                    </div>
                }
                <div class="font-sans-serif text-lg">
                    @Html.Raw(Model.TextContent)
                </div>
            </article>

            <!-- Action Buttons -->
            <div class="flex justify-between items-center w-full md:w-1/2 pb-3 sticky bottom-0 bg-transparent">
                <div class="bg-white rounded-sm">
                    <button id="delete-button" class="nav-button text-gray-400 hover:text-gray-600" title="@SharedLocalizer["DeleteButton"]">
                        <i class="icofont-bin"></i>
                    </button>
                </div>
                <div class="bg-white rounded-sm">
                    <button id="edit-button" class="nav-button text-gray-400 hover:text-gray-600 hidden" title="@Localizer["CopyButton"]">
                        <i class="icofont-loop"></i>
                    </button>
                </div>
                <div class="bg-white rounded-sm">
                    <button id="copy-link-button" class="btn btn-primary" title="@SharedLocalizer["CopyLinkButton"]">
                        <i class="icofont-link mr-2"></i>
                        @SharedLocalizer["CopyLinkButton"]
                    </button>
                </div>
            </div>
        </div>
    </section>
</div>

<!-- Modal -->
<div id="report-modal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden">
    <div class="bg-white rounded-lg w-11/12 md:w-1/3 shadow-lg">
        <div class="p-6">
            <div class="flex flex-col items-center mb-4">
                <i class="icofont-exclamation-tringle text-4xl text-red-600"></i>
            </div>
            <div class="text-center px-4">
                <p class="font-sans-serif text-lg text-gray-600 mb-4">
                    @Localizer["You are about to report this content. Use the feature in case of inappropriate content only. This action restricts access to the content for all viewers. Are you sure?"]
                </p>
            </div>
        </div>
        <div class="flex justify-end p-4 border-t border-gray-200">
            <button class="nav-button mr-4"
                    data-dismiss="modal"
                    tabindex="5"
                    type="button">
                @Localizer["CancelButton"]
            </button>
            <button id="report-button"
                    class="btn btn-primary"
                    tabindex="4"
                    type="button">
                @Localizer["ReportButton"]
            </button>
        </div>
    </div>
</div>

<partial name="Shared/Footer" />