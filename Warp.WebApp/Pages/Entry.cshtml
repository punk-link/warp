@page "/entry/{id}"
@using Microsoft.Extensions.Localization
@model EntryModel
@inject Microsoft.AspNetCore.Mvc.Localization.IViewLocalizer Localizer
@inject IStringLocalizer<SharedResources> SharedLocalizer

@{
    ViewData["Title"] = SharedLocalizer["Title"];
}

@section MetaTags {
    <meta name="robots" content="noindex, noarchive">
    <partial name="Shared/Components/OpenGraph" model="@Model.OpenGraphModel" />
}

@section Scripts {
    <script type="module" src="~/js/components/modal.js" defer></script>
    <script type="module" defer>
        import { addEntryEvents } from '/js/entry.js';

        document.addEventListener('DOMContentLoaded', () => {
            addEntryEvents('@Model.Id', '@Model.ExpiresIn');
        });

    </script>
}

<div class="min-h-screen">
    <div class="flex items-baseline px-3">
        <h1 class="logo">
            <a class="text-primary" asp-area="" asp-page="/Index">
                @SharedLocalizer["Logo"]
            </a>
        </h1>
    </div>

    <section class="min-h-[75vh] px-3 mb-5 flex flex-col justify-between">
        <div>
            <div class="flex flex-wrap">
                <div class="flex items-end w-full">
                    <div class="w-full md:w-1/2 flex items-center">
                        <i class="icofont-eye mr-2 text-gray-300"></i>@Model.ViewCount
                    </div>
                    <div class="w-full md:w-1/2 flex flex-col items-end">
                        <div class="text-right countdown">&nbsp;</div>
                        <div class="text-right text-gray-300 text-xl">@Localizer["the entry expires in"]</div>
                    </div>
                </div>
            </div>
            <article class="my-5">
                @if (Model.ImageContainers.Count > 0)
                {
                    <div class="gallery">
                        @foreach (var imageContainer in Model.ImageContainers)
                        {
                            <partial name="Shared/Components/ReadOnlyImageContainer" model="imageContainer" />
                        }
                    </div>
                }
                @Html.Raw(Model.TextContent)
            </article>
        </div>
        <div class="flex justify-between items-center w-full md:w-1/2 mx-auto sticky bottom-0 bg-transparent pb-3">
            <div class="bg-white rounded-sm">
                <a class="text-blue-500 hover:underline" data-toggle="modal" data-target="#report-modal" title="@Localizer["ReportButton"]">
                    <i class="icofont-exclamation-tringle text-red-600"></i>
                </a>
            </div>
            <div>
                <button id="page-close-button" class="text-gray-700 hover:underline">@Localizer["CloseButton"]</button>
            </div>
            <div class="bg-white rounded-sm">
                <a id="copy-url-button" class="text-gray-300 hover:underline" title="@SharedLocalizer["CopyLinkButton"]">
                    <i class="icofont-link text-gray-300"></i>
                </a>
            </div>
        </div>
    </section>
</div>

<div id="report-modal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden">
    <div class="bg-white rounded-lg w-11/12 md:w-1/3">
        <div class="p-4">
            <div class="flex flex-col items-center mb-3 text-secondary">
                <i class="icofont-exclamation-tringle text-4xl"></i>
            </div>
            <div class="px-4">
                <p class="mb-4">
                    @Localizer["You are about to report this content. Use the feature in case of inappropriate content only. This action restricts access to the content for all viewers. Are you sure?"]
                </p>
            </div>
        </div>
        <div class="flex justify-end p-4 border-t">
            <button class="text-gray-700 hover:underline mr-4" data-dismiss="modal" tabindex="5" type="button">@Localizer["CancelButton"]</button>
            <button id="report-button" class="bg-blue-500 text-white px-4 py-2 rounded" tabindex="4" type="button">@Localizer["ReportButton"]</button>
        </div>
    </div>
</div>

<partial name="Shared/Footer" />